<?phpsession_start();$token = (!empty($_GET['token'])) ? $_GET['token'] : '';if (empty($token) || empty($_SESSION[$token])) {    die("Access denied");}// elFinder autoloadrequire 'autoload.php';// Enable FTP connector netmountelFinder::$netDrivers['ftp'] = 'FTP';/** * Simple function to demonstrate how to control file access using "accessControl" callback. * This method will disable accessing files/folders starting from '.' (dot) * * @param string $attr attribute name (read|write|locked|hidden) * @param string $path absolute file path * @param string $data value of volume option `accessControlData` * @param object $volume elFinder volume driver object * @param bool|null $isDir path is directory (true: directory, false: file, null: unknown) * @param string $relpath file path relative to volume root directory started with directory separator * @return bool|null **/function access($attr, $path, $data, $volume, $isDir, $relpath){    $basename = basename($path);    return $basename[0] === '.'                  // if file/folder begins with '.' (dot)    && strlen($relpath) !== 1           // but with out volume root        ? !($attr == 'read' || $attr == 'write') // set read+write to false, other (locked+hidden) set to true        : null;                                 // else elFinder decide it itself}// Base URLfunction baseUrl($atRoot = false, $atCore = false, $parse = false){    if (isset($_SERVER['HTTP_HOST'])) {        $http = isset($_SERVER['HTTPS']) && strtolower($_SERVER['HTTPS']) !== 'off' ? 'https' : 'http';        $hostname = $_SERVER['HTTP_HOST'];        $dir = str_replace(basename($_SERVER['SCRIPT_NAME']), '', $_SERVER['SCRIPT_NAME']);        $core = preg_split('@/@', str_replace($_SERVER['DOCUMENT_ROOT'], '', realpath(dirname(__FILE__))), NULL, PREG_SPLIT_NO_EMPTY);        $core = $core[0];        $tmplt = $atRoot ? ($atCore ? "%s://%s/%s/" : "%s://%s/") : ($atCore ? "%s://%s/%s/" : "%s://%s%s");        $end = $atRoot ? ($atCore ? $core : $hostname) : ($atCore ? $core : $dir);        $base_url = sprintf($tmplt, $http, $hostname, $end);    } else $base_url = 'http://localhost/';    if ($parse) {        $base_url = parse_url($base_url);        if (isset($base_url['path'])) if ($base_url['path'] == '/') $base_url['path'] = '';    }    return $base_url;}// Documentation for connector options:$pathToFile = '../../../upload/filemanager/';$urlToFile = dirname(str_replace('elfinder/php/', '', baseUrl())) . '/upload/filemanager/';$opts = array(    // 'debug' => true,    'roots' => array(        // Items volume        array(            'driver' => 'LocalFileSystem',           // driver for accessing file system (REQUIRED)            'path' => $pathToFile,                 // path to files (REQUIRED)            'URL' => $urlToFile, // URL to files (REQUIRED)            'trashHash' => 't1_Lw',                     // elFinder's hash of trash folder            'winHashFix' => DIRECTORY_SEPARATOR !== '/', // to make hash same to Linux one on windows too            'uploadDeny' => array('all'),                // All Mimetypes not allowed to upload            'uploadAllow' => array('image/x-ms-bmp', 'image/gif', 'image/jpeg', 'image/png', 'image/x-icon', 'text/plain', 'application/vnd.ms-office', 'application/msword', 'application/vnd.ms-word', 'application/vnd.ms-excel', 'application/vnd.ms-powerpoint', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.openxmlformats-officedocument.presentationml.presentation', 'application/vnd.oasis.opendocument.text', 'application/vnd.oasis.opendocument.spreadsheet', 'application/vnd.oasis.opendocument.presentation', 'application/gzip', 'application/zip', 'application/rar', 'application/pdf', 'image/tiff', 'application/vnd.ms-office', 'application/msword', 'application/vnd.ms-word', 'application/vnd.ms-excel', 'application/vnd.ms-powerpoint', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.openxmlformats-officedocument.presentationml.presentation', 'application/postscript', 'application/rtf', 'text/html'), // Mimetype `image` and `text/plain` allowed to upload            'uploadOrder' => array('deny', 'allow'),      // allowed Mimetype `image` and `text/plain` only            'accessControl' => 'access'                     // disable and hide dot starting files (OPTIONAL)            // disable and hide dot starting files (OPTIONAL)        ),        // Trash volume        array(            'id' => '1',            'driver' => 'Trash',            'path' => $pathToFile . '.trash/',            'tmbURL' => $urlToFile . '.trash/.tmb/',            'winHashFix' => DIRECTORY_SEPARATOR !== '/', // to make hash same to Linux one on windows too            'uploadDeny' => array('all'),                // Recomend the same settings as the original volume that uses the trash            'uploadAllow' => array('image/x-ms-bmp', 'image/gif', 'image/jpeg', 'image/png', 'image/x-icon', 'text/plain'), // Same as above            'uploadOrder' => array('deny', 'allow'),      // Same as above            'accessControl' => 'access',                    // Same as above        ),    ));// Create dir trashif (!is_dir($pathToFile . '.trash/')) {    mkdir($pathToFile . '.trash/', 0777, true);}// run elFinder$connector = new elFinderConnector(new elFinder($opts));$connector->run();